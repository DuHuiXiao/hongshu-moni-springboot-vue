# 系统架构 🌐
该项目的系统架构为前端与后端分离架构。

## 前端技术栈 ⚙️
### 1. 框架/库 🏗️
- **Vue.js** 🌟：渐进式 JavaScript 框架。

### 2. 状态管理 📊
- **Pinia** 📦：集中化状态管理。

### 3. 路由管理 🛣️
- **Vue Router** 🛤️（Vue.js）：官方路由管理工具。

### 4. UI 组件库 🎨
- **ElementPlus** 🎉：基于 Vue.js 的组件库。

### 5. 构建工具 ⚡
- **Vite** 🚀：快速开发服务器和构建工具。

### 6. 样式和预处理器 🎨
- **Less** 🎨：CSS 预处理器。

### 7. API 请求 🌐
- **Axios** 📞：Promise-based HTTP 客户端。

---

## 后端技术栈 💻
### 1. 框架 🏛️
- **Spring Boot** 🐉：Java 的微服务框架。

### 2. 数据存储 🗄️
- **MySQL** 🗄️
- **Redis** 🧠：内存中的键值存储，支持持久化。
- **MyBatisPlus** 🔄：对数据库的操作和 SQL 映射的框架。
- **七牛云对象存储 OSS** ☁️

### 3. 认证与授权 🔑
- **JWT** 🔐：基于令牌的身份验证。
- **Md5** 🔒：加密密码进行存储，保护用户账号安全。

### 4. API 文档 📜
- **Postman** 📚：API 测试和文档生成工具。

### 5. 缓存 🧊
- **Redis** 🧠：内存中的键值存储。

### 6. 网关 🚪
- **Spring Cloud Gateway** 🌉：API 网关。

### 7. 搜索和数据分析引擎 🔍
- **ElasticSearch** 🔎：搜索引擎。

---

## app-auth 模块 🔑
### 逻辑概述 📝
- **用户登录**：接收用户登录信息，验证后返回用户信息和 Token。
- **获取用户信息**：验证 Access Token 的有效性，返回对应的用户信息。如果 Token 过期，提示客户端刷新 Token。
- **用户注册**：接收用户注册信息，保存新用户并返回用户信息和 Token。
- **检查用户是否已注册**：接收手机号或邮箱，检查用户是否存在，返回布尔值。
- **退出登录**：接收用户 ID，清除相关会话或 Token 信息。
- **刷新 Token**：验证 Refresh Token 的有效性，生成新的 Access Token 和 Refresh Token 并返回。如果 Refresh Token 过期，提示客户端重新登录。
## Redis 操作汇总 📊

### 登录时 (login 方法) 📝
- **存入：**
  - `AuthConstant.REFRESH_TOKEN_START_TIME + userId`：存储用户的刷新令牌创建时间，用于后续判断是否需要重新生成刷新令牌。
  - `AuthConstant.USER_KEY + userId`：将用户信息保存到 Redis 中，以便快速获取用户数据。

### 验证码登录时 (loginByCode 方法) 📱
- **读取：**
  - `AuthConstant.CODE + phone/email`：尝试从 Redis 中获取验证码，用于验证用户输入的验证码是否正确（当前代码中该功能被注释掉了）。

### 注册时 (register 方法) 🆕
- **存入：**
  - `AuthConstant.REFRESH_TOKEN_START_TIME + userId`：存储用户的刷新令牌创建时间。
  - `AuthConstant.USER_KEY + userId`：将新注册的用户信息保存到 Redis 中。

### 登出时 (loginOut 方法) 🚪
- **删除：**
  - `AuthConstant.USER_KEY + userId`：删除用户信息。
  - `AuthConstant.REFRESH_TOKEN_START_TIME + userId`：删除刷新令牌创建时间。

### 刷新令牌时 (refreshToken 方法) 🔄
- **读取：**
  - `AuthConstant.REFRESH_TOKEN_START_TIME + userId`：获取刷新令牌的创建时间，用于判断是否需要重新生成刷新令牌。
  
- **存入/更新：**
  - 如果刷新令牌即将过期，则重新生成刷新令牌，并更新 `AuthConstant.REFRESH_TOKEN_START_TIME + userId` 的值为当前时间。

### 注意
对密码的处理：用了加密算法对密码进行加密，并保存到数据库中。

---

### 总结 📋
该控制器实现了用户认证和授权的核心功能，包括登录、注册、获取用户信息、退出登录、修改密码以及 Token 的管理和刷新。

---

## app-common 模块 ⚙️
- 存放通用工具类、配置和常量类。

---

## app-gateway 模块 🌉
- **Spring Cloud Gateway** 🚪 会进行转发，将请求转发到对应的服务上。
- 具体来说，当一个请求到达网关时，Gateway 会检查所有配置的路由规则，并根据 predicates 来匹配请求。如果请求满足某个路由规则的条件，Gateway 就会将该请求转发到该规则中指定的 uri。

---

## app-im 模块 💬
### 逻辑概述 📝
- **发送消息**：接收消息内容并调用服务发送消息，返回成功响应。
- **获取聊天记录**：分页获取与指定用户的聊天记录。
- **获取聊天用户列表**：获取当前用户的所有聊天对象。
- **获取聊天记录数量**：统计当前用户的聊天记录总数。
- **关闭聊天会话**：根据用户 ID 关闭会话，返回操作是否成功。

### 总结 📋
该控制器实现了聊天功能的核心操作，包括发送消息、获取聊天记录、以及关闭聊天会话。

---

## app-platform 模块 📊
- 对以下功能进行了实现：
  - 分类 🗂️
  - 评论 💬
  - 关注 👥
  - 点赞 👍
  - 收藏 📥
  - 笔记 📝
  - 标签 🏷️
  - 笔记和标签的关系

---

## app-search 模块 🔍
### 逻辑概述 📝
- **搜索对应的笔记**：根据指定条件分页搜索笔记。
- **分页查询推荐笔记**：分页查询推荐笔记。
- **增加笔记**：新增一条笔记。
- **修改笔记**：更新指定 ID 的笔记信息。
- **批量增加笔记**：批量新增多条笔记。
- **删除 ES 中的笔记**：根据笔记 ID 删除 Elasticsearch 中的笔记。

### 总结 📋
该控制器实现了笔记管理的核心功能，包括：
- 分页搜索笔记（支持条件查询）
- 分页查询推荐笔记
- 新增单条笔记
- 更新笔记信息
- 批量新增笔记
- 删除 Elasticsearch 中的笔记

通过这些功能，用户可以方便地管理和操作笔记数据。部分接口无需登录即可访问，使功能更加开放和灵活。

---

## app-xo 模块 🗂️
- 存放 Mapper 的 xml 文件（这是 MyBatis 的配置文件，用于映射 SQL 语句）
- 存放实体类。 

